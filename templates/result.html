<!DOCTYPE html>
<html>
    <head>
        <title>YouTube Video Summarizer</title>
        <link rel="stylesheet" href="./static/style.css">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

        <style>
            html, body {
                background: linear-gradient(to bottom right, #f48ccc 0%, #6696e8 100%);
                height: 100%;
                margin: 0;
                padding: 0;
            }
            .container {
                width: 80%;
                height: 80%;
                margin: 0 auto;
                padding: 10px;
                background-color: white;
                border-radius: 20px;
                box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);
                display: flex;
                flex-direction: row;
                align-items: center;
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
            }

            .summary-text-container {
                height: 55vh;
                overflow-y: auto;
                margin-top: 20px;
                margin-bottom: 20px;
                border: 1px solid transparent; /* Invisible border */
                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1), /* Horizontal and vertical offset */
                0 -4px 6px rgba(0, 0, 0, 0.1), /* Top shadow */
                4px 0 6px rgba(0, 0, 0, 0.1), /* Right shadow */
                -4px 0 6px rgba(0, 0, 0, 0.1);  /* Border shadow */
                padding: 10px; /* Optional: add padding for better content spacing */
                border-radius: 8px; /* Optional: rounded corners */
            }

            .summary-text-container::-webkit-scrollbar {
            width: 8px; /* Width of the scrollbar */
        }

        .summary-text-container::-webkit-scrollbar-track {
            background: #f1f1f1; /* Track color */
            border-radius: 10px; /* Optional: rounded track corners */
        }

        .summary-text-container::-webkit-scrollbar-thumb {
            background-color: #888; /* Thumb color */
            border-radius: 10px; /* Rounded corners for the thumb */
            border: 2px solid #f1f1f1; /* Optional: space between thumb and track */
        }

        .summary-text-container::-webkit-scrollbar-thumb:hover {
            background-color: #555; /* Color on hover */
        }

        /* Scrollbar styling for Firefox */
        .summary-text-container {
            scrollbar-width: thin; /* Thin scrollbar */
            scrollbar-color: #888 #f1f1f1; /* Thumb and track colors */
        }

        </style>
    </head>
    <body>
        <!-- <iframe width="560" height="315" src="{{url}}" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>-->
         <!-- <p>{{url}}</p> -->
         <div class="container">
            <iframe width="800" height="400"  src="{{url}}" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
            <div style="margin-left: 1.5vw; height: max-content;">
                <div class="summary-text-container" >
                    <h2>Summary Text</h2>
                    <p style="text-align: justify;" id="summaryContent">
                    </p>
                </div>
                
                <div class="audio-container" style="height: 20vh; margin-top: 20px;">
                <h2>Summary Audio</h2>
                <audio controls>
                    <source src="./static/summary.mp3" type="audio/mpeg">
                    Your browser does not support the audio element.
                </audio>
                 </div>
            </div>
        </div>
    </body>
    <script>
        // Example of summary_text with markers
        const summaryText = `{{ summary_text | safe }}`;

        // Function to parse and format the summary_text
        function formatSummaryText(text) {
            const container = document.getElementById('summaryContent');

            // Split the text into lines
            const lines = text.split('.');

            // Initialize variables for managing the list state
            let currentList = null;

            // Iterate over each line to process formatting
            lines.forEach(line => {
                if (line.trim().startsWith('**')) {
                    // If line starts with **, create a new heading
                    if (currentList) {
                        // If there's an ongoing list, end it
                        container.appendChild(currentList);
                        currentList = null;
                    }

                    const heading = document.createElement('h5');
                    heading.innerText = line.replace(/\*\*/g, '').trim(); // Remove ** markers
                    container.appendChild(heading);
                } else if (line.trim().startsWith('*')) {
                    // If line starts with *, create a new list item
                    if (!currentList) {
                        // If no ongoing list, start a new one
                        currentList = document.createElement('ul');
                    }

                    const listItem = document.createElement('li');
                    listItem.innerHTML = line.replace(/\*/g, '').trim(); // Remove * markers
                    currentList.appendChild(listItem);
                } else if (line.trim() !== '') {
                    // If line doesn't start with markers, it's a paragraph
                    if (currentList) {
                        // If there's an ongoing list, end it
                        container.appendChild(currentList);
                        currentList = null;
                    }

                    const paragraph = document.createElement('p');
                    paragraph.innerText = line.trim();
                    container.appendChild(paragraph);
                }
            });

            // Append any remaining list
            if (currentList) {
                container.appendChild(currentList);
            }
        }

        // Call the function to format and display the summary
        formatSummaryText(summaryText);
    </script>
</html>
